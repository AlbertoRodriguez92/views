<html>
	<head>
		<link type="text/css" href="css/style.css" rel="stylesheet">
	</head>
	<body>
		<header>
            <nav id="menu">
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="">Mis datos</a></li>
                    <li><a href="">Cerrar sesion</a></li>
                </ul>
            </nav>
        </header>
		<div id="form-login">
			<section class="contenido">
				<label>Nombre de Usuario: </label>
				<input id="usuario" type="text">
				<label>Contrase√±a: </label>
				<input id="contrasena" type="password">
				<button value="Iniciar sesion" onclick="enviaDatos();" >Enviar Datos</button>
			</section>
		</div>
		<div id="demo"></div>
	</body>
	<script type="application/javascript">
	var name, rol;
	function enviaDatos(){

		var user = document.getElementById("usuario").value;
		var pass = document.getElementById("contrasena").value;

		var xmlhttp = new XMLHttpRequest();
		xmlhttp.onreadystatechange = function(){
            if(this.readyState == 4 && this.status==200){
				name = xmlhttp.responseText;
                document.getElementById("demo").innerHTML = name;

				var xhr = new XMLHttpRequest();

				xhr.open("GET", "http://localhost:8080/rol/"+name);
        		xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
				xhr.onerror = function(error){
					console.log("Se produjo un error")
				}
				xhr.onreadystatechange = function(){
					if(this.readyState == 4 && this.status==200){
						rol = xhr.responseText;
						document.getElementById("demo").innerHTML=rol;
						console.log(rol);
						if(rol==7){
							location.href="/views/index.html";
						}

					}
				}
        		xhr.send(JSON.stringify({nombre:name
        		}));
            }
        }
        xmlhttp.open("POST", "http://localhost:8080/login");
        xmlhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
		xmlhttp.onerror = function(error){
			console.log("Se produjo un error")
		}
        xmlhttp.send(JSON.stringify({username:user, password: pass
        }));

	}

	</script>
</html>
